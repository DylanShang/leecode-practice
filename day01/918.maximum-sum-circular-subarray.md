class Solution:
    #O(n) O(n)
    def maxSubarraySumCircular(self, nums: List[int]) -> int:
        n = len(nums)
        @cache
        def dp(i,sign):
            if i==0: 
                return nums[0] * sign
            else:
                return nums[i]*sign + max(0,dp(i-1,sign))
        max_p_value = max(dp(v,1) for v in range(n))
        max_n_value = max(dp(v,-1) for v in range(n))

        return max_p_value if max_p_value < 0 else max(max_p_value,sum(nums)+max_n_value)